import{d as N,a as j,b as A,o as p,e as m,f as e,F as y,g as E,t as w,h as c}from"./index.55b93d80.js";import{U as M}from"./concepto.f0f3421d.js";import{U as T}from"./pago.7c759e8f.js";const U={class:"bg-white shadow"},D={class:"px-4 sm:px-6 lg:max-w-6xl lg:mx-auto lg:px-8"},H={class:"py-6 md:flex md:items-center md:justify-between lg:border-t lg:border-gray-200"},I={class:"mt-6 flex space-x-3 justify-end w-full md:mt-0 md:ml-4"},L={class:"mt-8"},R={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},V={class:"sm:col-span-6"},z=e("label",{for:"cover-photo",class:"block text-sm font-medium text-gray-700"}," Pago banco ",-1),X={class:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},q={class:"space-y-1 text-center"},G=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z"})],-1),J={class:"flex text-sm text-gray-600"},K={for:"file-upload",class:"relative cursor-pointer bg-white rounded-md font-medium text-info hover:text-cyan-700 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-info"},O=e("span",null,"Cargar un archivo",-1),Q=e("p",{class:"pl-1"}," o arrastrar y soltar ",-1),W=e("p",{class:"text-xs text-gray-500"}," TXT, BATCH up to 10MB ",-1),Y=e("h2",{class:"max-w-6xl mx-auto mt-8 px-4 text-lg leading-6 font-medium text-gray-900 sm:px-6 lg:px-8"}," Listado de archivos ",-1),Z={class:"hidden sm:block"},ee={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},te={class:"flex flex-col mt-2"},se={class:"align-middle min-w-full overflow-x-auto shadow overflow-hidden sm:rounded-lg"},oe={class:"min-w-full divide-y divide-gray-200"},ne=e("thead",null,[e("tr",null,[e("th",{class:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Persona "),e("th",{class:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Documento "),e("th",{class:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," N\xFAmero de operaci\xF3n "),e("th",{class:"hidden px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider md:block"}," Importe "),e("th",{class:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Concepto "),e("th",{class:"px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Fecha ")])],-1),ae={key:0,class:"bg-white divide-y divide-gray-200"},ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium"},re={class:"px-6 py-4 text-left whitespace-nowrap text-sm text-gray-500"},le={class:"hidden px-6 py-4 whitespace-nowrap text-sm text-gray-500 md:block"},de={class:"px-6 py-4 text-left whitespace-nowrap text-sm text-gray-500 font-medium space-x-1"},pe={class:"px-6 py-4 text-left whitespace-nowrap text-sm text-gray-500 font-medium space-x-1"},me={key:1,class:"bg-white divide-y divide-gray-200"},xe=e("tr",{class:"bg-white"},[e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",colspan:"7"}," No hay registros ")],-1),ue=[xe],ye=N({setup(he){const _=M(),b=T(),n=j([]),v=async x=>{try{await(()=>new Promise(t=>{const r=x.target,s=new FileReader;s.onload=function(){const u=s.result;t(u)},r.files&&s.readAsText(r.files[0])}))().then(t=>{t.split(`
`).forEach(s=>{const u=s.slice(35,43),B=s.slice(112,113),g=_.get_concepto_by_codigo(u);if(g&&Number(B)===2){const o={};let l=s.slice(47,62);l=l.trim(),l=l.slice(7,15);let h=s.slice(121,156);h=h.trim();let d=s.slice(79,87);const P=d.slice(0,4),C=d.slice(4,6),F=d.slice(6,8);d=`${P}-${C}-${F}`;const S=s.slice(18,25);let a=s.slice(62,77),f="";f=a.slice(13,15)[0],a=a.slice(1,13),a=`${a}.${f}`;const $=parseFloat(a);o.nombre_cliente=h,o.numero_documento=l,o.numero_operacion=S,o.fecha_operacion=d,o.monto=$,o.concepto=g.id,o.is_active=!0,n.value.push(o)}})})}catch(i){alert(i)}},k=async()=>{if(!await b.save_pagos(n.value)){w("Error al subir pagos",{type:"danger",timeout:5e3,hideProgressBar:!0});return}w(`Se Procesaron : ${n.value.length} Nuevos pagos`,{type:"success",timeout:3e3,hideProgressBar:!0}),n.value=[],document.getElementById("file-upload").value=""};return A(()=>{_.set_conceptos("")}),(x,i)=>(p(),m(y,null,[e("div",U,[e("div",D,[e("div",H,[e("div",I,[e("button",{type:"button",class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-cyan-600 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500",onClick:i[0]||(i[0]=t=>k())}," Procesar ")])])])]),e("div",L,[e("div",R,[e("div",V,[z,e("div",X,[e("div",q,[G,e("div",J,[e("label",K,[O,e("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",onChange:v},null,32)]),Q]),W])])])]),Y,e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[e("table",oe,[ne,n.value.length>0?(p(),m("tbody",ae,[(p(!0),m(y,null,E(n.value,(t,r)=>(p(),m("tr",{key:r,class:"bg-white"},[e("td",ce,c(t.nombre_cliente),1),e("td",ie,c(t.numero_documento),1),e("td",re,c(t.numero_operacion),1),e("td",le,c(t.monto),1),e("td",de,c(t.concepto),1),e("td",pe,c(t.fecha_operacion),1)]))),128))])):(p(),m("tbody",me,ue))])])])])])])],64))}});export{ye as default};
